name: Build Android Debug APK

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repo
        uses: actions/checkout@v3

      - name: Unzip Project
        run: |
          unzip Android13AppFinal_ready.zip -d project
          ls -R project

      - name: Set up JDK 17
        uses: actions/setup-java@v3
        with:
          distribution: 'temurin'
          java-version: '17'

      # üëá ‡§Ø‡§π‡§æ‡§Ç ‡§π‡§Æ ‡§™‡•Å‡§∞‡§æ‡§®‡§æ Gradle version ‡§á‡§∏‡•ç‡§§‡•á‡§Æ‡§æ‡§≤ ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á
      - name: Setup Gradle 7.6.2
        uses: gradle/gradle-build-action@v2
        with:
          gradle-version: 7.6.2

      # gradlew wrapper generate ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§®‡§æ, ‡§™‡•Å‡§∞‡§æ‡§®‡§æ gradle ‡§π‡•Ä ‡§ö‡§≤‡•á‡§ó‡§æ
      - name: Make gradlew executable
        working-directory: project
        run: chmod +x ./gradlew || echo "gradlew not found, using global gradle"

      - name: Build Debug APK
        working-directory: project
        run: |
          if [ -f "./gradlew" ]; then
            ./gradlew assembleDebug
          else
            gradle assembleDebug
          fi

      - name: Upload APK
        uses: actions/upload-artifact@v4
        with:
          name: MyApp
          path: project/app/build/outputs/apk/debug/*.apk
